Namespace(a_lambda=0.0001, abit=4, alpha_init=10.0, batch_size=128, clp=True, data_path='./dataset/', dataset='cifar10', epochs=200, evaluate=False, fine_tune=False, gammas=[0.5, 0.1], k=2, log_file='vgg7_quant_w4_a4_modedorefa_wd1e-4.log', lr=0.05, lr_decay='step', model='vgg7_quant', momentum=0.9, ngpu=1, print_freq=1, q_mode='dorefa', resume='', save_path='./save/vgg7_quant/vgg7_quant_w4_a4_mode_dorefa_wd1e-4/', schedule=[60, 120], use_cuda=True, wbit=4, weight_decay=0.0001, workers=16)
==> Building model..

VGG_quant(
  (features): Sequential(
    (0): QConv2d(
      3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): QConv2d(
      128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (4): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): QConv2d(
      128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (8): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ReLU(inplace=True)
    (10): QConv2d(
      256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (11): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU(inplace=True)
    (13): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): QConv2d(
      256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (15): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): ReLU(inplace=True)
    (17): QConv2d(
      512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (18): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): ReLU(inplace=True)
    (20): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (classifier): Sequential(
    (0): QLinear(
      in_features=8192, out_features=1024, bias=True, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
    (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): QLinear(
      in_features=1024, out_features=10, bias=True, wbit=4, abit=4
      (weight_quant): WQ()
      (act_quant): AQ()
    )
  )
)
----  --------  ---------  --------  ---------  ---------  --------  ----------
  ep        lr    tr_loss    tr_acc    tr_time    te_loss    te_acc    best_acc
----  --------  ---------  --------  ---------  ---------  --------  ----------
   1    0.0500     3.3611   31.5000    17.6100     1.5582   43.0100     43.0100
   2    0.0500     1.6498   43.0920    17.5557     1.4106   49.0100     49.0100
   3    0.0500     1.4616   50.1940    17.5406     1.2195   56.4700     56.4700
   4    0.0500     1.3043   56.0440    17.6221     1.1792   59.0900     59.0900
   5    0.0500     1.1779   60.6820    17.7225     1.0207   64.6800     64.6800
   6    0.0500     1.0832   64.2960    17.6518     1.0059   65.6700     65.6700
   7    0.0500     0.9843   67.7240    17.7412     0.8934   68.5800     68.5800
   8    0.0500     0.9061   70.3460    17.7908     0.7961   72.2800     72.2800
   9    0.0500     0.8406   72.6780    17.7008     0.7347   74.6700     74.6700
  10    0.0500     0.7754   74.8920    17.8221     0.6883   76.0400     76.0400
  11    0.0500     0.7272   76.3160    17.9405     0.6589   77.8200     77.8200
  12    0.0500     0.6789   78.0100    17.8331     0.6559   77.4300     77.8200
  13    0.0500     0.6317   79.4560    18.1433     0.5976   79.7300     79.7300
  14    0.0500     0.5995   80.6760    17.9958     0.5963   79.4700     79.7300
  15    0.0500     0.5646   81.8900    18.1854     0.5869   80.4700     80.4700
  16    0.0500     0.5348   82.6260    18.0039     0.5828   80.3500     80.4700
  17    0.0500     0.5075   83.6360    18.0727     0.5250   82.5100     82.5100
  18    0.0500     0.4826   84.4540    18.2057     0.5020   83.2700     83.2700
  19    0.0500     0.4619   85.2040    18.1986     0.5046   83.5100     83.5100
  20    0.0500     0.4369   85.9640    18.2375     0.4834   84.0400     84.0400
  21    0.0500     0.4227   86.3240    18.1554     0.5829   81.7600     84.0400
  22    0.0500     0.4061   86.8620    18.1841     0.5116   83.3200     84.0400
  23    0.0500     0.3844   87.5140    18.2356     0.4812   84.3200     84.3200
  24    0.0500     0.3715   87.9540    18.2101     0.5336   82.3400     84.3200
  25    0.0500     0.3523   88.5980    18.4159     0.4660   84.8200     84.8200
  26    0.0500     0.3393   89.0500    18.4649     0.4583   85.4500     85.4500
  27    0.0500     0.3180   89.7960    18.2826     0.4496   85.4500     85.4500
  28    0.0500     0.3087   89.9480    18.3292     0.4620   84.5500     85.4500
  29    0.0500     0.2981   90.3760    18.3381     0.4955   84.5700     85.4500
  30    0.0500     0.2887   90.6660    18.3543     0.5287   83.5500     85.4500
  31    0.0500     0.2671   91.4740    18.4126     0.4709   85.5900     85.5900
  32    0.0500     0.2592   91.6220    18.5761     0.4275   86.2700     86.2700
  33    0.0500     0.2540   91.7880    18.5694     0.4266   86.5800     86.5800
  34    0.0500     0.2424   92.1440    18.3320     0.4341   86.4100     86.5800
  35    0.0500     0.2416   92.1080    18.4346     0.5950   83.2300     86.5800
  36    0.0500     0.2280   92.5880    18.4436     0.4461   86.5000     86.5800
  37    0.0500     0.2150   92.9460    18.4577     0.4456   86.5300     86.5800
  38    0.0500     0.2124   93.1100    18.3656     0.4663   86.3600     86.5800
  39    0.0500     0.2026   93.3900    18.4746     0.4449   87.1100     87.1100
  40    0.0500     0.1920   93.7420    18.5544     0.4433   87.2200     87.2200
  41    0.0500     0.1901   93.8340    18.3583     0.4177   86.9900     87.2200
  42    0.0500     0.1798   94.1780    18.4422     0.4269   87.4500     87.4500
  43    0.0500     0.1674   94.6140    18.4373     0.4168   87.4800     87.4800
  44    0.0500     0.1608   94.7800    18.4403     0.4173   87.7600     87.7600
  45    0.0500     0.1567   94.8040    18.3949     0.4178   87.5800     87.7600
  46    0.0500     0.1591   94.8520    18.4146     0.4172   87.6700     87.7600
  47    0.0500     0.1460   95.3560    18.6191     0.4418   88.0200     88.0200
  48    0.0500     0.1462   95.1960    18.4914     0.4066   88.1600     88.1600
  49    0.0500     0.1414   95.3620    18.4157     0.4403   87.3500     88.1600
  50    0.0500     0.1362   95.5660    18.4101     0.4051   87.6500     88.1600
  51    0.0500     0.1260   95.9240    18.4480     0.4224   88.0200     88.1600
  52    0.0500     0.1302   95.7380    18.3852     0.4192   87.9900     88.1600
  53    0.0500     0.1330   95.6500    18.4624     0.4208   87.5600     88.1600
  54    0.0500     0.1280   95.8860    18.4566     0.4542   87.9200     88.1600
  55    0.0500     0.1238   95.8920    18.4393     0.4185   87.9400     88.1600
  56    0.0500     0.1105   96.4540    18.5067     0.4135   88.0700     88.1600
  57    0.0500     0.1096   96.4380    18.5026     0.4298   88.1000     88.1600
  58    0.0500     0.1114   96.2820    18.6493     0.4078   88.9500     88.9500
  59    0.0500     0.1039   96.6500    18.4312     0.4365   87.8500     88.9500
  60    0.0500     0.1000   96.7560    18.4657     0.4181   88.3700     88.9500
  61    0.0250     0.0657   98.1120    18.6303     0.3386   90.4600     90.4600
  62    0.0250     0.0494   98.6900    18.7113     0.3403   90.6900     90.6900
  63    0.0250     0.0448   98.7900    18.5178     0.3444   90.4500     90.6900
  64    0.0250     0.0424   98.9160    18.4925     0.3630   90.3800     90.6900
  65    0.0250     0.0402   98.9040    18.4714     0.3607   90.4300     90.6900
  66    0.0250     0.0385   98.9460    18.5131     0.3575   90.3100     90.6900
  67    0.0250     0.0388   98.9700    18.4554     0.3765   90.4200     90.6900
  68    0.0250     0.0360   99.0300    18.6846     0.3673   90.8000     90.8000
  69    0.0250     0.0360   99.0160    18.4759     0.3728   90.2400     90.8000
  70    0.0250     0.0323   99.1580    18.5627     0.3633   90.5900     90.8000
  71    0.0250     0.0312   99.1940    18.5858     0.3506   91.0000     91.0000
  72    0.0250     0.0315   99.2040    18.5145     0.3669   90.6400     91.0000
  73    0.0250     0.0316   99.1660    18.4791     0.3631   90.5400     91.0000
  74    0.0250     0.0302   99.2780    18.5347     0.3749   90.6500     91.0000
  75    0.0250     0.0299   99.2140    18.4903     0.3678   90.6800     91.0000
  76    0.0250     0.0266   99.3540    18.5365     0.3692   90.7000     91.0000
  77    0.0250     0.0266   99.3160    18.5948     0.3701   90.6700     91.0000
  78    0.0250     0.0282   99.2860    18.5292     0.3775   90.4500     91.0000
  79    0.0250     0.0274   99.3060    18.5639     0.3708   90.7200     91.0000
  80    0.0250     0.0278   99.2520    18.5828     0.3697   90.6800     91.0000
  81    0.0250     0.0270   99.2640    18.5764     0.3842   90.4700     91.0000
  82    0.0250     0.0255   99.3340    18.6165     0.4018   90.3400     91.0000
  83    0.0250     0.0247   99.3520    18.5210     0.3894   90.4700     91.0000
  84    0.0250     0.0269   99.2680    18.5752     0.3777   90.5400     91.0000
  85    0.0250     0.0268   99.3240    18.6001     0.3951   90.7900     91.0000
  86    0.0250     0.0280   99.2220    18.6091     0.3995   90.3900     91.0000
  87    0.0250     0.0266   99.2720    18.6088     0.3751   90.4600     91.0000
  88    0.0250     0.0268   99.2680    18.5279     0.3706   90.5100     91.0000
  89    0.0250     0.0249   99.3540    18.6044     0.3682   90.7700     91.0000
  90    0.0250     0.0241   99.3740    18.5720     0.3867   90.4500     91.0000
  91    0.0250     0.0262   99.2760    18.6186     0.3713   90.7300     91.0000
  92    0.0250     0.0229   99.4300    18.6460     0.3854   90.5700     91.0000
  93    0.0250     0.0256   99.2880    18.6016     0.3729   90.6400     91.0000
  94    0.0250     0.0232   99.3940    18.6248     0.3849   90.6500     91.0000
  95    0.0250     0.0222   99.4640    18.6506     0.3984   90.1900     91.0000
  96    0.0250     0.0238   99.3640    18.5751     0.3708   90.6200     91.0000
  97    0.0250     0.0212   99.4460    18.6115     0.3706   90.7600     91.0000
  98    0.0250     0.0215   99.4940    18.6059     0.3598   90.9000     91.0000
  99    0.0250     0.0241   99.3440    18.6447     0.3879   90.6900     91.0000
 100    0.0250     0.0232   99.3920    18.6377     0.3833   90.6700     91.0000
 101    0.0250     0.0241   99.3320    18.5930     0.4156   90.0600     91.0000
 102    0.0250     0.0265   99.2500    18.5769     0.3760   90.5200     91.0000
 103    0.0250     0.0275   99.2160    18.6379     0.3825   90.5200     91.0000
 104    0.0250     0.0245   99.3160    18.5844     0.3760   90.5000     91.0000
 105    0.0250     0.0222   99.4300    18.6477     0.3820   90.1600     91.0000
 106    0.0250     0.0217   99.4160    18.5754     0.4039   90.3100     91.0000
 107    0.0250     0.0227   99.4020    18.5988     0.3962   90.2200     91.0000
 108    0.0250     0.0250   99.3100    18.6427     0.4179   90.1300     91.0000
 109    0.0250     0.0219   99.4280    18.6216     0.3790   91.0000     91.0000
 110    0.0250     0.0240   99.3280    18.6750     0.3808   90.3100     91.0000
 111    0.0250     0.0216   99.4220    18.5865     0.3817   90.6200     91.0000
 112    0.0250     0.0223   99.3760    18.6047     0.3970   90.2700     91.0000
 113    0.0250     0.0212   99.4460    18.6393     0.3744   90.5600     91.0000
 114    0.0250     0.0192   99.5180    18.5924     0.3932   90.2100     91.0000
 115    0.0250     0.0196   99.5000    18.6865     0.3862   90.4900     91.0000
 116    0.0250     0.0200   99.4780    18.6283     0.3838   90.5700     91.0000
 117    0.0250     0.0211   99.4240    18.5996     0.4011   90.1100     91.0000
 118    0.0250     0.0219   99.4300    18.6956     0.4009   90.2300     91.0000
 119    0.0250     0.0218   99.3980    18.7197     0.3899   90.6100     91.0000
 120    0.0250     0.0237   99.2960    18.6949     0.3889   90.5200     91.0000
 121    0.0025     0.0141   99.6900    18.7080     0.3384   91.5400     91.5400
 122    0.0025     0.0112   99.7820    18.6824     0.3364   91.4400     91.5400
 123    0.0025     0.0099   99.8500    18.8552     0.3329   91.5700     91.5700
 124    0.0025     0.0094   99.8580    18.8669     0.3349   91.7000     91.7000
 125    0.0025     0.0086   99.8760    18.6933     0.3314   91.5700     91.7000
 126    0.0025     0.0084   99.8940    18.8659     0.3376   91.8700     91.8700
 127    0.0025     0.0082   99.8700    18.7174     0.3304   91.7700     91.8700
 128    0.0025     0.0078   99.9020    18.6562     0.3392   91.7300     91.8700
 129    0.0025     0.0075   99.9080    18.6723     0.3334   91.8000     91.8700
 130    0.0025     0.0073   99.9040    18.6844     0.3290   91.8300     91.8700
 131    0.0025     0.0070   99.9080    18.9414     0.3233   91.8800     91.8800
 132    0.0025     0.0068   99.9260    18.6057     0.3295   91.8300     91.8800
 133    0.0025     0.0066   99.9360    18.8730     0.3282   91.9300     91.9300
 134    0.0025     0.0064   99.9320    18.7106     0.3243   91.7700     91.9300
 135    0.0025     0.0067   99.9280    18.7189     0.3335   91.7900     91.9300
 136    0.0025     0.0059   99.9620    18.6403     0.3280   91.8400     91.9300
 137    0.0025     0.0063   99.9280    18.6838     0.3311   91.8400     91.9300
 138    0.0025     0.0061   99.9440    18.7295     0.3305   91.8800     91.9300
 139    0.0025     0.0057   99.9620    18.9367     0.3320   92.0600     92.0600
 140    0.0025     0.0062   99.9340    18.6915     0.3383   91.8400     92.0600
 141    0.0025     0.0057   99.9520    18.6525     0.3344   91.7200     92.0600
 142    0.0025     0.0056   99.9620    18.6897     0.3325   91.9500     92.0600
 143    0.0025     0.0058   99.9560    18.7260     0.3334   92.0200     92.0600
 144    0.0025     0.0060   99.9460    18.9623     0.3270   92.1200     92.1200
 145    0.0025     0.0055   99.9640    18.6694     0.3310   92.0300     92.1200
 146    0.0025     0.0056   99.9460    18.6361     0.3315   92.0300     92.1200
 147    0.0025     0.0053   99.9620    18.7057     0.3342   92.0100     92.1200
 148    0.0025     0.0056   99.9460    18.6859     0.3366   92.0100     92.1200
 149    0.0025     0.0058   99.9380    18.7174     0.3338   91.9600     92.1200
 150    0.0025     0.0055   99.9580    18.6916     0.3313   91.9800     92.1200
